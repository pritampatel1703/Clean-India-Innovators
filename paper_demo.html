<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crumpled Paper Reveal</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #f0f0f0;
            font-family: 'Poppins', sans-serif;
        }

        #canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
            /* Let clicks pass through if needed */
        }

        /* The Message Overlay */
        #message-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            text-align: center;
            opacity: 0;
            /* Hidden initially */
            z-index: 2;
            pointer-events: none;
            color: #2D2D2D;
        }

        #message-container h2 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #077f5b;
        }

        #message-container p {
            font-size: 1rem;
        }

        /* UI to restart */
        .controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }

        button {
            padding: 10px 20px;
            background: #077f5b;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
        }
    </style>

    <link rel="apple-touch-icon" sizes="180x180" href="LOGO/dp.png">
    <meta property="og:title" content="Clean India Innovators">
    <meta property="og:description" content="Solutions for a Sustainable Future">
    <meta property="og:image" content="http://clean-india-innovators.netlify.app/og-image.png">
    <meta property="og:url" content="https://clean-india-innovators.netlify.app">
    <meta property="og:type" content="website">
</head>

<body>

    <div id="canvas-container"></div>

    <div id="message-container">
        <!-- This content will sit "on top" of the open paper visually -->
        <h2>Save the Planet!</h2>
        <p>Every small action counts. Dispose of waste responsibly.</p>
    </div>

    <div class="controls">
        <button onclick="replayAnimation()">Throw Again</button>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
        // --- 1. SETUP THREE.JS ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();

        // Orthographic camera might be better for "2D-like" alignment, 
        // but Perspective looks more "3D throw". Let's stick to Perspective.
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 10;

        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        container.appendChild(renderer.domElement);

        // Lights
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(ambientLight);
        const dirLight = new THREE.DirectionalLight(0xffffff, 1);
        dirLight.position.set(5, 5, 5);
        scene.add(dirLight);

        // --- 2. LOAD MODELS ---
        const loader = new THREE.GLTFLoader();

        let crumpledPaper = null;
        let plainPage = null;
        let isLoaded = false;

        // Load Crumpled Paper
        loader.load('3d%20model/crumbled_paper.glb', (gltf) => {
            crumpledPaper = gltf.scene;
            // Normalize scale (adjust based on actual model size)
            crumpledPaper.scale.set(20, 20, 20); // Guessing scale, will adjust
            crumpledPaper.visible = false;
            scene.add(crumpledPaper);
            checkLoad();
        }, undefined, (error) => console.error('Error loading crumpled paper:', error));

        // Load Plain Page
        loader.load('3d%20model/Meshy_AI_crumbled_plain_page_0103085721_texture.glb', (gltf) => {
            plainPage = gltf.scene;
            // The plain page likely needs to look like a flat sheet facing the camera
            plainPage.scale.set(15, 15, 15);
            // Rotate to face camera if needed (usually models are flat on Y or Z)
            plainPage.rotation.x = Math.PI / 2;
            plainPage.visible = false;
            scene.add(plainPage);
            checkLoad();
        }, undefined, (error) => console.error('Error loading plain page:', error));

        function checkLoad() {
            if (crumpledPaper && plainPage) {
                isLoaded = true;
                replayAnimation();
            }
        }

        // --- 3. ANIMATION SEQUENCE ---
        function replayAnimation() {
            if (!isLoaded) return;

            // Reset States
            const msg = document.getElementById('message-container');
            msg.style.opacity = 0;

            // Start Position (Bottom Left)
            // Normalized screen coordinates roughly: x: -5, y: -4
            crumpledPaper.position.set(-8, -6, 0);
            crumpledPaper.rotation.set(0, 0, 0);
            crumpledPaper.visible = true;

            plainPage.visible = false;
            plainPage.scale.set(0, 0, 0); // Start tiny for "expansion" effect
            plainPage.position.set(0, 0, 0);

            // GSAP Timeline
            const tl = gsap.timeline();

            // Step 1: Throw Crumpled Paper to Center
            tl.to(crumpledPaper.position, {
                x: 0,
                y: 0,
                z: 0,
                duration: 1.2,
                ease: "power2.out"
            }, "throw");

            // Spin it while throwing
            tl.to(crumpledPaper.rotation, {
                x: Math.PI * 2,
                y: Math.PI * 2,
                duration: 1.2,
                ease: "power2.out"
            }, "throw");

            // Step 2: "Pop" / Switch Models
            tl.call(() => {
                crumpledPaper.visible = false;
                plainPage.visible = true;
            });

            // Step 3: Open Up (Scale Up Plain Page)
            // Assuming "Plain Page" is the flat version. 
            // We scale it up from 0 to full size to simulate unfolding/appearing
            tl.to(plainPage.scale, {
                x: 20, // Adjust these target scales to match model size
                y: 20,
                z: 20,
                duration: 0.5,
                ease: "back.out(1.7)" // Bouncy effect
            });

            // Adjust rotation to face camera perfectly
            tl.to(plainPage.rotation, {
                x: Math.PI / 2, // Adjust depending on model orientation
                y: 0,
                z: 0,
                duration: 0.5
            }, "<");

            // Step 4: Fade In Message
            tl.to(msg, {
                opacity: 1,
                duration: 0.5
            });
        }

        // --- 4. RENDER LOOP ---
        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
        animate();

        // Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

    </script>
</body>

</html>